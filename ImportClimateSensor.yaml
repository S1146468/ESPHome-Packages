substitutions:
  __device_name__: climate
  __friendly_name__: "Climate"
  __climate__: climate.name
  __internal__: "true"



text_sensor:
  - platform: homeassistant
    id: ${__device_name__}_temperature_raw
    entity_id: ${__climate__}
    attribute: temperature
    internal: true  # hide from HA if you don't need it exposed
    on_value:
      then:
        - lambda: |-
            float temp = std::stof(id(${__device_name__}_temperature_raw).state);
            id(${__device_name__}_temperature).publish_state(temp);

  - platform: homeassistant
    id: ${__device_name__}_state_raw
    entity_id: ${__climate__}
    internal: true
    on_value:
      then:
        - lambda: |-
            std::string state = id(${__device_name__}_state_raw).state;
            if (state == "off") {
              id(${__device_name__}_state).publish_state(false);
            } else {
              id(${__device_name__}_state).publish_state(true);
            }

sensor:
  - platform: template 
    name: "${__friendly_name__} Target Temperature"
    id: ${__device_name__}_temperature
    unit_of_measurement: "Â°C"
    device_class: temperature
    state_class: measurement
    update_interval: never
    internal: ${__internal__}
    
binary_sensor:
  - platform: template
    name: "${__friendly_name__} Heat State"
    id: ${__device_name__}_state
    internal: ${__internal__}
